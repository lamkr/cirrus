container:
  image: cirrusci/flutter:latest

test_task:
  upgrade_script:
    #- flutter channel master
    #- flutter upgrade
    
  sdkmanager_list:
    $ANDROID_HOME/sdkmanager --list
    #$ANDROID_HOME/toos/bin/sdkmanager --list
    
  list_devices_script:
    avdmanager list
    
  create_device_script:
    echo no | avdmanager create avd --force
        -n test
        -k "system-images;android-28;default;armeabi-v7a"
  
  start_emulator_background_script:
    $ANDROID_HOME/emulator/emulator
        -avd test
        -no-audio
        -no-window
  
  wait_for_emulator_script:
    - adb wait-for-device
  
  pub_cache:
    folder: ~/.pub-cache
    
  test_script: flutter test
  
